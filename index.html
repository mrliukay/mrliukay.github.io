<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>LiuKai - 1319897531@qq.com</title><meta name="author" content="liukai"><meta name="copyright" content="liukai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="一个不掉头发的Java程序员~~~">
<meta property="og:type" content="website">
<meta property="og:title" content="LiuKai">
<meta property="og:url" content="http://mrkay0313.gitee.io/liukai/index.html">
<meta property="og:site_name" content="LiuKai">
<meta property="og:description" content="一个不掉头发的Java程序员~~~">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://gitee.com/mrkay0313/images/raw/master/img/avatar.png">
<meta property="article:author" content="liukai">
<meta property="article:tag" content="程序员">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://gitee.com/mrkay0313/images/raw/master/img/avatar.png"><link rel="shortcut icon" href="http://gitee.com/mrkay0313/images/raw/master/img/favicon.png"><link rel="canonical" href="http://mrkay0313.gitee.io/liukai/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/liukai/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/liukai/',
  algolia: undefined,
  localSearch: {"path":"/liukai/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'LiuKai',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-06-24 08:11:15'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://mrkay0313.gitee.io/liukai/css/transpancy.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="http://gitee.com/mrkay0313/images/raw/master/img/avatar.png" onerror="onerror=null;src='http://gitee.com/mrkay0313/images/raw/master/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/liukai/archives/"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/liukai/tags/"><div class="headline">标签</div><div class="length-num">16</div></a><a href="/liukai/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/liukai/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/archives/"><i class="fa-fw fas fa-archive"></i><span> 博文</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('http://gitee.com/mrkay0313/images/raw/master/img/archive.jpg')"><nav id="nav"><span id="blog-info"><a href="/liukai/" title="LiuKai"><span class="site-name">LiuKai</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/liukai/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/archives/"><i class="fa-fw fas fa-archive"></i><span> 博文</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">LiuKai</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://blog.csdn.net/weixin_44848900" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="mailto:1319897531@qq.com" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/liukai/2023/12/10/AOP%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%8F%8D%E5%B0%84%E9%87%8D%E8%AE%BE%E5%B1%9E%E6%80%A7%E5%80%BC/" title="AOP中使用反射重设属性值"><img class="post-bg" src="https://gitee.com/mrkay0313/images/raw/master/img/35d9316f450041b89232893f083a57f1.jpg" onerror="this.onerror=null;this.src='/liukai/'" alt="AOP中使用反射重设属性值"></a></div><div class="recent-post-info"><a class="article-title" href="/liukai/2023/12/10/AOP%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%8F%8D%E5%B0%84%E9%87%8D%E8%AE%BE%E5%B1%9E%E6%80%A7%E5%80%BC/" title="AOP中使用反射重设属性值">AOP中使用反射重设属性值</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-12-10T02:22:05.000Z" title="发表于 2023-12-10 10:22:05">2023-12-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a></span></div><div class="content">AOP中使用反射重设属性值1 摘要
工作中一直使用框架,第三方工具包…这些别人封装好的东西确实方便了不少,但是有的时候某些业务需要用到一部分基础知识.
本文是在工作中遇到的一个需求,需求是这样的:
用户登陆后需要根据此用户的不同角色对每个接口传入一个公共参数,从数据库过滤出满足当前用户可以查看的数据.

2 分析解决
解决这类问题能想到的可能会有:拦截器,AOP等
我这里的解决方案就是使用AOP配合接口注解的形式,拦截自定义注解的接口,获取到参数,使用反射修改通用参数中的设置用户角色的参数;

3 代码实现
由于基本思路有了基本的代码实现也就简单了,所以这里直接附上代码即可

3.1 自定义注解
注解只需要在方法上使用即可

1234@Retention(RetentionPolicy.RUNTIME)@Target(&#123;ElementType.METHOD&#125;)public @interface ASP &#123;&#125;

3.2 通用参数
后期所有牵扯到需要判断角色的数据都需要在方法的参数列表中加上此实体或者其子类用户介手通用参数codeList

1234 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/liukai/2023/10/02/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%AE%9E%E7%8E%B0/" title="网云穿设置内网穿透"><img class="post-bg" src="https://gitee.com/mrkay0313/images/raw/master/img/20230914223927.png" onerror="this.onerror=null;this.src='/liukai/'" alt="网云穿设置内网穿透"></a></div><div class="recent-post-info"><a class="article-title" href="/liukai/2023/10/02/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%AE%9E%E7%8E%B0/" title="网云穿设置内网穿透">网云穿设置内网穿透</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-10-02T02:22:05.000Z" title="发表于 2023-10-02 10:22:05">2023-10-02</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/%E8%BF%90%E7%BB%B4%E6%9C%8D%E5%8A%A1%E5%99%A8/">运维服务器</a></span></div><div class="content">记录一次使用网云穿实现内网穿透操作

摘要
这段时间也很少写博客了,一方面工作表较忙,一方面觉得有些东西在百度上都能找到,甚至比我自己记录的详细,有些笔记也就没打,
这次记录笔记主要是觉得这个 网云穿 很好用,分享给大家.


1  什么是内网穿透?
内网穿透也叫内网映射，将本地服务器内网IP端口提供到外网，实现外网连接访问的过程。内网穿透可以将原本只能在本机、本局域网内访问的项目网站等，实现外网也同样可以访问。

2  内网穿透有什么用途?
最直接的作用就是可以对方可以使用外网直接访问你本地的或者局域网(当然一般需要公网IP);
举个我的例子,这段时间一直出差,我带的自己的笔记本电脑,但是项目需要和前端联调,我和前端又不在同一局域网下(不在同一网段),这个时候其实解决方式有很多,最常见的一般有两种:

发测试,前端调用测试进行联调;
内网穿透,直接调我本地联调;

第一种解决方式如果公司使用的容器化部署(docker等),并且测试服务器提供的有公网IP可以直接访问这种其实最舒服,IDEA中直接一个运行就发到测试了,也很方便;
第二种内网穿透就不必多说了,直接调用的我本地,随时随地断点 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/liukai/2023/05/25/OpenFeign/" title="OpenFeign"><img class="post-bg" src="http://gitee.com/mrkay0313/images/raw/master/img/20231002142345.png" onerror="this.onerror=null;this.src='/liukai/'" alt="OpenFeign"></a></div><div class="recent-post-info"><a class="article-title" href="/liukai/2023/05/25/OpenFeign/" title="OpenFeign">OpenFeign</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-25T15:06:04.000Z" title="发表于 2023-05-25 23:06:04">2023-05-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BB%84%E4%BB%B6/">分布式组件</a></span></div><div class="content">OpenFeign记录
摘要:
本篇博客主要接受啊OpenFeign的相关知识点

1 什么是Feign
在介绍Feign之前先介绍一下Feign
Feign集成了Ribbon、RestTemplate实现了负载均衡的执行Http调用，只不过对原有的方式（Ribbon+RestTemplate）进行了封装，开发者不必手动使用RestTemplate调服务，而是定义一个接口，在这个接口中标注一个注解即可完成服务调用，这样更加符合面向接口编程的宗旨，简化了开发。
OpenFeign其实就是Feign的一种升级罢了。但是Feign后期停止了迭代，所以现在很多新企业和公司开始使用OpenFeign，虽然目前也有很多企业也在使用Feign。

2  OpenFeign
OpenFeign在原来的Feign的基础山增加了支持SpringMVC的注解, 比如@RequestMapping(“&#x2F;path”)注解, 此外配合@FeignClient注解可以可以通过动态代理的形式产生实现类,调用其他服务的接口.

1234567891011@FeignClient(contextId = &qu ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/liukai/2023/05/20/SPEL%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="SPEL表达式"><img class="post-bg" src="http://gitee.com/mrkay0313/images/raw/master/img/20231002142345.png" onerror="this.onerror=null;this.src='/liukai/'" alt="SPEL表达式"></a></div><div class="recent-post-info"><a class="article-title" href="/liukai/2023/05/20/SPEL%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="SPEL表达式">SPEL表达式</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-20T14:37:10.000Z" title="发表于 2023-05-20 22:37:10">2023-05-20</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/Spring/">Spring</a></span></div><div class="content">SPEL表达式
照耀本篇文章主要介绍SPEL表达式的一些简单用法

1 SPEL表达式介绍
其实SPEL表达式和我们平时用的EL表达式很相似,我们用的最多的注解@Value注解就得到了体现;
但是EL表达式想要动态注入一些属性就显得比较无力了,这时候SPEL表达式就更先方便一些.

2 路径跳转
由于SPEL表达式其实在实际项目当中使用的并不是太多,多以这里就不再进行这么多记录了,这里直接贴上另一位技术博主的一篇博文即可:
SpringBoot技术实践-SpEL&amp;EL表达式

</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/liukai/2023/05/14/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE-Gateway%E8%B6%85%E6%97%B6%E9%85%8D%E7%BD%AE/" title="Pig开源项目-Gateway超时配置"><img class="post-bg" src="http://gitee.com/mrkay0313/images/raw/master/img/20231002142415.png" onerror="this.onerror=null;this.src='/liukai/'" alt="Pig开源项目-Gateway超时配置"></a></div><div class="recent-post-info"><a class="article-title" href="/liukai/2023/05/14/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE-Gateway%E8%B6%85%E6%97%B6%E9%85%8D%E7%BD%AE/" title="Pig开源项目-Gateway超时配置">Pig开源项目-Gateway超时配置</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-14T15:47:32.000Z" title="发表于 2023-05-14 23:47:32">2023-05-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BB%84%E4%BB%B6/">分布式组件</a></span></div><div class="content">网关超时配置
摘要:
本篇文章主要介绍Gateway网关超时配置

1 超时配置概念
路由超时配置可以为所有路由配置Http超时（响应和连接），并为每个特定路由覆盖Http超时。
简单来说就是
我们可以给网关配置全局超时 和 特定路由超时
并且如果前者配置了后者也配置,那么后者会覆盖前者的超时配置;

2 具体配置
下面是代码实现超时配置的方案

2.1 全局超时配置123456spring:  cloud:    gateway:      httpclient:        connect-timeout: 1000        response-timeout: 10s



connect-timeout 必须以毫秒为单位指定连接超时时间.
response-timeout 必须指定为java.time.Duration


2.2 特定路由超时配置12345678- id: pig-upms      # 唯一的服务ID  uri: lb://pig-upms # 注册中心的服务名称，实现负载均衡  predicates:  - Path=/admin/demo  #所有 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/liukai/2023/05/14/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE-%E7%BD%91%E5%85%B3%E9%99%90%E6%B5%81/" title="Pig开源项目-网关限流"><img class="post-bg" src="http://gitee.com/mrkay0313/images/raw/master/img/20231002142415.png" onerror="this.onerror=null;this.src='/liukai/'" alt="Pig开源项目-网关限流"></a></div><div class="recent-post-info"><a class="article-title" href="/liukai/2023/05/14/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE-%E7%BD%91%E5%85%B3%E9%99%90%E6%B5%81/" title="Pig开源项目-网关限流">Pig开源项目-网关限流</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-14T09:01:09.000Z" title="发表于 2023-05-14 17:01:09">2023-05-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BB%84%E4%BB%B6/">分布式组件</a></span></div><div class="content">网关限流
摘要:
本篇文章主要介绍Gateway实现限流的方式–令牌桶

1 限流概念
限流是对某一时间窗口内的请求数进行限制,保持系统的可用性和稳定性,防止因为流量暴增而导致的系统运行缓慢或宕机.

2 常见的限流方案
常见的限流算法有：计数器算法，漏桶（Leaky Bucket）算法，令牌桶（Token Bucket）算法。

3 Gateway限流方式
Spring Cloud Gateway官方提供了RequestRateLimiterGatewayFilterFactory过滤器工厂，使用Redis 和Lua脚本实现了 令牌桶 的方式。

3.1 令牌桶限流介绍
令牌桶算法 是对漏桶算法的一种改进，漏桶算法能够限制请求调用的速率，而令牌桶算法能够在限制调用的平均速率的同时还允许一定程度的突发调用。在令牌桶算法中，存在一个桶，用来存放固定数量的令牌。算法中存在一种机制，以一定的速率往桶中放令牌。每次请求调用需要先获取令牌，只有拿到令牌，才有机会继续执行，否则选择选择等待可用的令牌、或者直接拒绝。
放令牌这个动作是持续不断的进行，如果桶中令牌数达到上限，就丢弃令牌。所以就存在这种 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/liukai/2023/05/11/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE-%E7%BD%91%E5%85%B3/" title="Pig开源项目-网关"><img class="post-bg" src="http://gitee.com/mrkay0313/images/raw/master/img/20231002142415.png" onerror="this.onerror=null;this.src='/liukai/'" alt="Pig开源项目-网关"></a></div><div class="recent-post-info"><a class="article-title" href="/liukai/2023/05/11/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE-%E7%BD%91%E5%85%B3/" title="Pig开源项目-网关">Pig开源项目-网关</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-11T03:06:52.000Z" title="发表于 2023-05-11 11:06:52">2023-05-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a></span></div><div class="content">网关学习
摘要:
本文主要介绍springcloud的gateway

1 Gateway简介
Spring Cloud Gateway是Spring官方基于Spring 5.0，Spring Boot 2.0和Project Reactor等技术开发的网关，Spring Cloud Gateway旨在为微服务架构提供一种简单而有效的统一的API路由管理方式。Spring Cloud Gateway作为Spring Cloud生态系中的网关，目标是替代ZUUL，其不仅提供统一的路由方式，并且基于Filter链的方式提供了网关基本的功能，例如：安全，监控&#x2F;埋点，和限流等。

2 为什么使用网关
在微服务架构中，一个系统往往由多个微服务组成，而这些服务可能部署在不同机房、不同地区、不同域名下。这种情况下，客户端（例如浏览器、手机、软件工具等）想要直接请求这些服务，就需要知道它们具体的地址信息，例如 IP 地址、端口号等。
这种客户端直接请求服务的方式存在以下问题：

当服务数量众多时，客户端需要维护大量的服务地址，这对于客户端来说，是非常繁琐复杂的;(硬编码维护确实不是办法)
在 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/liukai/2023/05/10/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0-package-info-java%E7%9A%84%E4%BD%9C%E7%94%A8/" title="Pig开源项目学习-package-info.java的作用"><img class="post-bg" src="http://gitee.com/mrkay0313/images/raw/master/img/20231002142355.png" onerror="this.onerror=null;this.src='/liukai/'" alt="Pig开源项目学习-package-info.java的作用"></a></div><div class="recent-post-info"><a class="article-title" href="/liukai/2023/05/10/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0-package-info-java%E7%9A%84%E4%BD%9C%E7%94%A8/" title="Pig开源项目学习-package-info.java的作用">Pig开源项目学习-package-info.java的作用</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-10T07:43:41.000Z" title="发表于 2023-05-10 15:43:41">2023-05-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/">Pig开源项目</a></span></div><div class="content">package-info.java的作用
摘要:
本文主要介绍Java中一种特殊的.java后缀java文件package-info.java作用

1 介绍
作用:

为标注在包上的注解Annotation提供便利 (我们可以统一处理该注解包下的所有类，比如初始化，检查等等)
声明友好类和包常量 
提供包的整体注释说明

概括:
pacakge-info.java是一个Java文件，可以添加到任何的Java源码包中。pacakge-info.java的目标是提供一个包级的文档说明或者是包级的注释。


pacakge-info.java文件中，唯一要求包含的内容是包的声明语句，比如:

12345/*** This is domain module, the core business logic is implemented here.**/package com.rickie.tracking.domain;



2 创建方式
IDEA中创建方式截图如下:


3 友链
详情参考:
https://cloud.tencent.com/developer/beta/article ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/liukai/2023/05/10/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0-git-commit-id-maven-plugin%E6%8F%92%E4%BB%B6/" title="Pig开源项目学习-git-commit-id-maven-plugin插件"><img class="post-bg" src="http://gitee.com/mrkay0313/images/raw/master/img/20231002142345.png" onerror="this.onerror=null;this.src='/liukai/'" alt="Pig开源项目学习-git-commit-id-maven-plugin插件"></a></div><div class="recent-post-info"><a class="article-title" href="/liukai/2023/05/10/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0-git-commit-id-maven-plugin%E6%8F%92%E4%BB%B6/" title="Pig开源项目学习-git-commit-id-maven-plugin插件">Pig开源项目学习-git-commit-id-maven-plugin插件</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-10T02:12:01.000Z" title="发表于 2023-05-10 10:12:01">2023-05-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/">Pig开源项目</a></span></div><div class="content">git-commit-id-maven-plugin插件简介
摘要
本篇文章主要介绍本人正在学习的一个分布式开源项目所设计的技术 git-commit-id-maven-plugin插件.
对于此插件我们实际中只需要知道它是什么怎么用即可,不作为重点记录对象.

1 简介
This plugin makes basic repository information available through maven resources. This can be used to display“what version is this?” or “who has deployed this and when, from which branch?” information at runtime, makingit easy to find things like “oh, that isn’t deployed yet, I’ll test it tomorrow” and making both testers anddevelopers life easier. See https:// ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/liukai/2023/04/21/%E8%AE%A2%E5%8D%95%E8%B6%85%E6%97%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-RocketMQ%E5%BB%B6%E8%BF%9F%E6%B6%88%E6%81%AF/" title="订单超时解决方案-RocketMQ延迟消息"><img class="post-bg" src="http://gitee.com/mrkay0313/images/raw/master/img/20231002142415.png" onerror="this.onerror=null;this.src='/liukai/'" alt="订单超时解决方案-RocketMQ延迟消息"></a></div><div class="recent-post-info"><a class="article-title" href="/liukai/2023/04/21/%E8%AE%A2%E5%8D%95%E8%B6%85%E6%97%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-RocketMQ%E5%BB%B6%E8%BF%9F%E6%B6%88%E6%81%AF/" title="订单超时解决方案-RocketMQ延迟消息">订单超时解决方案-RocketMQ延迟消息</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-04-21T06:24:15.000Z" title="发表于 2023-04-21 14:24:15">2023-04-21</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BB%84%E4%BB%B6/">分布式组件</a></span></div><div class="content">订单超时解决方案RocketMQ延时消息
摘要:
本文主要介绍RocketMQ延时消息解决订单超时问题

1 RocketMQ简介
可以参考阿里云社区的这篇文章,写的很详细,并带有实际举例说明:
https://developer.aliyun.com/article/780968

2 延时消息解决订单超时问题

</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/liukai/page/2/#content-inner">2</a><a class="extend next" rel="next" href="/liukai/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="http://gitee.com/mrkay0313/images/raw/master/img/avatar.png" onerror="this.onerror=null;this.src='http://gitee.com/mrkay0313/images/raw/master/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">liukai</div><div class="author-info__description">一个不掉头发的Java程序员~~~</div></div><div class="card-info-data site-data is-center"><a href="/liukai/archives/"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/liukai/tags/"><div class="headline">标签</div><div class="length-num">16</div></a><a href="/liukai/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://gitee.com/mrkay0313"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://blog.csdn.net/weixin_44848900" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="mailto:1319897531@qq.com" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">感谢各位百忙之中浏览本人博客，博客基于hexo构建。主要用于记录个人技术总结，如果图片出不来可能是缓存原因请刷新页面或者清理浏览器缓存试一下哦~~~最后左下角可以和博主一起"网抑云"哦~~~</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/liukai/2023/12/10/AOP%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%8F%8D%E5%B0%84%E9%87%8D%E8%AE%BE%E5%B1%9E%E6%80%A7%E5%80%BC/" title="AOP中使用反射重设属性值"><img src="https://gitee.com/mrkay0313/images/raw/master/img/35d9316f450041b89232893f083a57f1.jpg" onerror="this.onerror=null;this.src='/liukai/'" alt="AOP中使用反射重设属性值"/></a><div class="content"><a class="title" href="/liukai/2023/12/10/AOP%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%8F%8D%E5%B0%84%E9%87%8D%E8%AE%BE%E5%B1%9E%E6%80%A7%E5%80%BC/" title="AOP中使用反射重设属性值">AOP中使用反射重设属性值</a><time datetime="2023-12-10T02:22:05.000Z" title="发表于 2023-12-10 10:22:05">2023-12-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/liukai/2023/10/02/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%AE%9E%E7%8E%B0/" title="网云穿设置内网穿透"><img src="https://gitee.com/mrkay0313/images/raw/master/img/20230914223927.png" onerror="this.onerror=null;this.src='/liukai/'" alt="网云穿设置内网穿透"/></a><div class="content"><a class="title" href="/liukai/2023/10/02/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%AE%9E%E7%8E%B0/" title="网云穿设置内网穿透">网云穿设置内网穿透</a><time datetime="2023-10-02T02:22:05.000Z" title="发表于 2023-10-02 10:22:05">2023-10-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/liukai/2023/05/25/OpenFeign/" title="OpenFeign"><img src="http://gitee.com/mrkay0313/images/raw/master/img/20231002142345.png" onerror="this.onerror=null;this.src='/liukai/'" alt="OpenFeign"/></a><div class="content"><a class="title" href="/liukai/2023/05/25/OpenFeign/" title="OpenFeign">OpenFeign</a><time datetime="2023-05-25T15:06:04.000Z" title="发表于 2023-05-25 23:06:04">2023-05-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/liukai/2023/05/20/SPEL%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="SPEL表达式"><img src="http://gitee.com/mrkay0313/images/raw/master/img/20231002142345.png" onerror="this.onerror=null;this.src='/liukai/'" alt="SPEL表达式"/></a><div class="content"><a class="title" href="/liukai/2023/05/20/SPEL%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="SPEL表达式">SPEL表达式</a><time datetime="2023-05-20T14:37:10.000Z" title="发表于 2023-05-20 22:37:10">2023-05-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/liukai/2023/05/14/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE-Gateway%E8%B6%85%E6%97%B6%E9%85%8D%E7%BD%AE/" title="Pig开源项目-Gateway超时配置"><img src="http://gitee.com/mrkay0313/images/raw/master/img/20231002142415.png" onerror="this.onerror=null;this.src='/liukai/'" alt="Pig开源项目-Gateway超时配置"/></a><div class="content"><a class="title" href="/liukai/2023/05/14/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE-Gateway%E8%B6%85%E6%97%B6%E9%85%8D%E7%BD%AE/" title="Pig开源项目-Gateway超时配置">Pig开源项目-Gateway超时配置</a><time datetime="2023-05-14T15:47:32.000Z" title="发表于 2023-05-14 23:47:32">2023-05-14</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/liukai/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/Java%E5%9F%BA%E7%A1%80/"><span class="card-category-list-name">Java基础</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"><span class="card-category-list-name">Pig开源项目</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/Spring/"><span class="card-category-list-name">Spring</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BB%84%E4%BB%B6/"><span class="card-category-list-name">分布式组件</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%BA%BF%E7%A8%8B%E6%B1%A0/"><span class="card-category-list-name">多线程线程池</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"><span class="card-category-list-name">微服务</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/%E6%95%99%E7%A8%8B/"><span class="card-category-list-name">教程</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="card-category-list-name">数据库</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/liukai/tags/openfeign/" style="font-size: 1.1em; color: #999">openfeign</a> <a href="/liukai/tags/AOP/" style="font-size: 1.1em; color: #999">AOP</a> <a href="/liukai/tags/Redis/" style="font-size: 1.1em; color: #999">Redis</a> <a href="/liukai/tags/CountDownLatch/" style="font-size: 1.1em; color: #999">CountDownLatch</a> <a href="/liukai/tags/butterfly/" style="font-size: 1.1em; color: #999">butterfly</a> <a href="/liukai/tags/hexo/" style="font-size: 1.1em; color: #999">hexo</a> <a href="/liukai/tags/JAVA/" style="font-size: 1.1em; color: #999">JAVA</a> <a href="/liukai/tags/%E6%8F%92%E4%BB%B6/" style="font-size: 1.1em; color: #999">插件</a> <a href="/liukai/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/" style="font-size: 1.1em; color: #999">内网穿透</a> <a href="/liukai/tags/%E7%BD%91%E5%85%B3/" style="font-size: 1.1em; color: #999">网关</a> <a href="/liukai/tags/redis-reactive%E9%99%90%E6%B5%81%E7%BB%84%E4%BB%B6/" style="font-size: 1.1em; color: #999">redis-reactive限流组件</a> <a href="/liukai/tags/MQ/" style="font-size: 1.5em; color: #99a9bf">MQ</a> <a href="/liukai/tags/%E7%89%B9%E6%AE%8Ajava%E6%96%87%E4%BB%B6/" style="font-size: 1.1em; color: #999">特殊java文件</a> <a href="/liukai/tags/SPEL/" style="font-size: 1.1em; color: #999">SPEL</a> <a href="/liukai/tags/ScheduledExecutorService/" style="font-size: 1.1em; color: #999">ScheduledExecutorService</a> <a href="/liukai/tags/Gateway%E8%B6%85%E6%97%B6%E9%85%8D%E7%BD%AE/" style="font-size: 1.1em; color: #999">Gateway超时配置</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/liukai/archives/2023/12/"><span class="card-archive-list-date">十二月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/liukai/archives/2023/10/"><span class="card-archive-list-date">十月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/liukai/archives/2023/05/"><span class="card-archive-list-date">五月 2023</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/liukai/archives/2023/04/"><span class="card-archive-list-date">四月 2023</span><span class="card-archive-list-count">5</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">14</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">10.9k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-06-24T00:11:15.335Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By liukai</div><div class="footer_custom_text">~~人生短短数十年,技术永远学不完~~</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/liukai/js/utils.js"></script><script src="/liukai/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js/dist/typed.umd.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["如果把童年再放映一遍，我们一定会先大笑，然后放声痛哭，最后挂着泪，微笑着睡去."])
  } else {
    document.getElementById("subtitle").textContent = "如果把童年再放映一遍，我们一定会先大笑，然后放声痛哭，最后挂着泪，微笑着睡去."
  }
}
typedJSFn.run(subtitleType)</script></div><div class="aplayer no-destroy" data-id="8301894281" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true" data-lrcType="-1"> </div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="false" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/liukai/js/search/local-search.js"></script></div></div><script src="/liukai/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/liukai/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html>