<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>LiuKai - 1319897531@qq.com</title><meta name="author" content="liukai"><meta name="copyright" content="liukai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="referrer" content="no-referrer"><meta name="description" content="一个不掉头发的Java程序员~~~">
<meta property="og:type" content="website">
<meta property="og:title" content="LiuKai">
<meta property="og:url" content="https://gitee.com/mrkay0313/index.html">
<meta property="og:site_name" content="LiuKai">
<meta property="og:description" content="一个不掉头发的Java程序员~~~">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/mrkay0313/img/avatar.png">
<meta property="article:author" content="liukai">
<meta property="article:tag" content="程序员">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/mrkay0313/img/avatar.png"><link rel="shortcut icon" href="/liukai/img/favicon.png"><link rel="canonical" href="https://gitee.com/mrkay0313/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/liukai/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/liukai/',
  algolia: undefined,
  localSearch: {"path":"/liukai/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'LiuKai',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-10-01 17:57:39'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/source/css/transpancy.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/loading.gif" data-original="/liukai/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/liukai/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/liukai/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/liukai/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/liukai/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/archives/"><i class="fa-fw fas fa-archive"></i><span> 博文</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/liukai/img/background.jpg')"><nav id="nav"><span id="blog-info"><a href="/liukai/" title="LiuKai"><span class="site-name">LiuKai</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/liukai/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/archives/"><i class="fa-fw fas fa-archive"></i><span> 博文</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/liukai/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">LiuKai</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://blog.csdn.net/weixin_44848900" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="mailto:1319897531@qq.com" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/liukai/2023/05/25/%E7%BC%93%E5%AD%98Redis%E7%9B%B8%E5%85%B3%E5%8A%9F%E8%83%BD/" title="缓存Redis相关功能">缓存Redis相关功能</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-25T15:22:05.000Z" title="发表于 2023-05-25 23:22:05">2023-05-25</time></span></div><div class="content"></div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/liukai/2023/05/25/OpenFeign/" title="OpenFeign">OpenFeign</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-25T15:06:04.000Z" title="发表于 2023-05-25 23:06:04">2023-05-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BB%84%E4%BB%B6/">分布式组件</a></span></div><div class="content">OpenFeign记录
摘要:
本篇博客主要接受啊OpenFeign的相关知识点

1 什么是Feign
在介绍Feign之前先介绍一下Feign
Feign集成了Ribbon、RestTemplate实现了负载均衡的执行Http调用，只不过对原有的方式（Ribbon+RestTemplate）进行了封装，开发者不必手动使用RestTemplate调服务，而是定义一个接口，在这个接口中标注一个注解即可完成服务调用，这样更加符合面向接口编程的宗旨，简化了开发。
OpenFeign其实就是Feign的一种升级罢了。但是Feign后期停止了迭代，所以现在很多新企业和公司开始使用OpenFeign，虽然目前也有很多企业也在使用Feign。

2  OpenFeign
OpenFeign在原来的Feign的基础山增加了支持SpringMVC的注解, 比如@RequestMapping(“&#x2F;path”)注解, 此外配合@FeignClient注解可以可以通过动态代理的形式产生实现类,调用其他服务的接口.

@FeignClient(contextId = &quot;remoteDept ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/liukai/2023/05/20/SPEL%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="SPEL表达式">SPEL表达式</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-20T14:37:10.000Z" title="发表于 2023-05-20 22:37:10">2023-05-20</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/Spring/">Spring</a></span></div><div class="content">SPEL表达式
照耀本篇文章主要介绍SPEL表达式的一些简单用法

1 SPEL表达式介绍
其实SPEL表达式和我们平时用的EL表达式很相似,我们用的最多的注解@Value注解就得到了体现;
但是EL表达式想要动态注入一些属性就显得比较无力了,这时候SPEL表达式就更先方便一些.

2 路径跳转
由于SPEL表达式其实在实际项目当中使用的并不是太多,多以这里就不再进行这么多记录了,这里直接贴上另一位技术博主的一篇博文即可:
SpringBoot技术实践-SpEL&amp;EL表达式

</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/liukai/2023/05/14/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE-Gateway%E8%B6%85%E6%97%B6%E9%85%8D%E7%BD%AE/" title="Pig开源项目-Gateway超时配置">Pig开源项目-Gateway超时配置</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-14T15:47:32.000Z" title="发表于 2023-05-14 23:47:32">2023-05-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BB%84%E4%BB%B6/">分布式组件</a></span></div><div class="content">网关超时配置
摘要:
本篇文章主要介绍Gateway网关超时配置

1 超时配置概念
路由超时配置可以为所有路由配置Http超时（响应和连接），并为每个特定路由覆盖Http超时。
简单来说就是
我们可以给网关配置全局超时 和 特定路由超时
并且如果前者配置了后者也配置,那么后者会覆盖前者的超时配置;

2 具体配置
下面是代码实现超时配置的方案

2.1 全局超时配置spring:  cloud:    gateway:      httpclient:        connect-timeout: 1000        response-timeout: 10s



connect-timeout 必须以毫秒为单位指定连接超时时间.
response-timeout 必须指定为java.time.Duration


2.2 特定路由超时配置- id: pig-upms      # 唯一的服务ID  uri: lb://pig-upms # 注册中心的服务名称，实现负载均衡  predicates:  - Path=/admin/demo  #所有业务的请求前缀  metad ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/liukai/2023/05/14/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE-%E7%BD%91%E5%85%B3%E9%99%90%E6%B5%81/" title="Pig开源项目-网关限流">Pig开源项目-网关限流</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-14T09:01:09.000Z" title="发表于 2023-05-14 17:01:09">2023-05-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BB%84%E4%BB%B6/">分布式组件</a></span></div><div class="content">网关限流
摘要:
本篇文章主要介绍Gateway实现限流的方式–令牌桶

1 限流概念
限流是对某一时间窗口内的请求数进行限制,保持系统的可用性和稳定性,防止因为流量暴增而导致的系统运行缓慢或宕机.

2 常见的限流方案
常见的限流算法有：计数器算法，漏桶（Leaky Bucket）算法，令牌桶（Token Bucket）算法。

3 Gateway限流方式
Spring Cloud Gateway官方提供了RequestRateLimiterGatewayFilterFactory过滤器工厂，使用Redis 和Lua脚本实现了 令牌桶 的方式。

3.1 令牌桶限流介绍
令牌桶算法 是对漏桶算法的一种改进，漏桶算法能够限制请求调用的速率，而令牌桶算法能够在限制调用的平均速率的同时还允许一定程度的突发调用。在令牌桶算法中，存在一个桶，用来存放固定数量的令牌。算法中存在一种机制，以一定的速率往桶中放令牌。每次请求调用需要先获取令牌，只有拿到令牌，才有机会继续执行，否则选择选择等待可用的令牌、或者直接拒绝。
放令牌这个动作是持续不断的进行，如果桶中令牌数达到上限，就丢弃令牌。所以就存在这种 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/liukai/2023/05/11/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE-%E7%BD%91%E5%85%B3/" title="Pig开源项目-网关">Pig开源项目-网关</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-11T03:06:52.000Z" title="发表于 2023-05-11 11:06:52">2023-05-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a></span></div><div class="content">网关学习
摘要:
本文主要介绍springcloud的gateway

1 Gateway简介
Spring Cloud Gateway是Spring官方基于Spring 5.0，Spring Boot 2.0和Project Reactor等技术开发的网关，Spring Cloud Gateway旨在为微服务架构提供一种简单而有效的统一的API路由管理方式。Spring Cloud Gateway作为Spring Cloud生态系中的网关，目标是替代ZUUL，其不仅提供统一的路由方式，并且基于Filter链的方式提供了网关基本的功能，例如：安全，监控&#x2F;埋点，和限流等。

2 为什么使用网关
在微服务架构中，一个系统往往由多个微服务组成，而这些服务可能部署在不同机房、不同地区、不同域名下。这种情况下，客户端（例如浏览器、手机、软件工具等）想要直接请求这些服务，就需要知道它们具体的地址信息，例如 IP 地址、端口号等。
这种客户端直接请求服务的方式存在以下问题：

当服务数量众多时，客户端需要维护大量的服务地址，这对于客户端来说，是非常繁琐复杂的;(硬编码维护确实不是办法)
在 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/liukai/2023/05/10/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0-package-info-java%E7%9A%84%E4%BD%9C%E7%94%A8/" title="Pig开源项目学习-package-info.java的作用">Pig开源项目学习-package-info.java的作用</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-10T07:43:41.000Z" title="发表于 2023-05-10 15:43:41">2023-05-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/">Pig开源项目</a></span></div><div class="content">package-info.java的作用
摘要:
本文主要介绍Java中一种特殊的.java后缀java文件package-info.java作用

1 介绍
作用:

为标注在包上的注解Annotation提供便利 (我们可以统一处理该注解包下的所有类，比如初始化，检查等等)
声明友好类和包常量 
提供包的整体注释说明

概括:
pacakge-info.java是一个Java文件，可以添加到任何的Java源码包中。pacakge-info.java的目标是提供一个包级的文档说明或者是包级的注释。


pacakge-info.java文件中，唯一要求包含的内容是包的声明语句，比如:

/*** This is domain module, the core business logic is implemented here.**/package com.rickie.tracking.domain;



2 创建方式
IDEA中创建方式截图如下:


3 友链
详情参考:
https://cloud.tencent.com/developer/beta/article/1874 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/liukai/2023/05/10/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0-git-commit-id-maven-plugin%E6%8F%92%E4%BB%B6/" title="Pig开源项目学习-git-commit-id-maven-plugin插件">Pig开源项目学习-git-commit-id-maven-plugin插件</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-10T02:12:01.000Z" title="发表于 2023-05-10 10:12:01">2023-05-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/">Pig开源项目</a></span></div><div class="content">git-commit-id-maven-plugin插件简介
摘要
本篇文章主要介绍本人正在学习的一个分布式开源项目所设计的技术 git-commit-id-maven-plugin插件.
对于此插件我们实际中只需要知道它是什么怎么用即可,不作为重点记录对象.

1 简介
This plugin makes basic repository information available through maven resources. This can be used to display“what version is this?” or “who has deployed this and when, from which branch?” information at runtime, makingit easy to find things like “oh, that isn’t deployed yet, I’ll test it tomorrow” and making both testers anddevelopers life easier. See https:// ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/liukai/2023/04/21/%E8%AE%A2%E5%8D%95%E8%B6%85%E6%97%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-RocketMQ%E5%BB%B6%E8%BF%9F%E6%B6%88%E6%81%AF/" title="订单超时解决方案-RocketMQ延迟消息">订单超时解决方案-RocketMQ延迟消息</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-04-21T06:24:15.000Z" title="发表于 2023-04-21 14:24:15">2023-04-21</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BB%84%E4%BB%B6/">分布式组件</a></span></div><div class="content">订单超时解决方案RocketMQ延时消息
摘要:
本文主要介绍RocketMQ延时消息解决订单超时问题

1 RocketMQ简介
可以参考阿里云社区的这篇文章,写的很详细,并带有实际举例说明:
https://developer.aliyun.com/article/780968

2 延时消息解决订单超时问题

</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/liukai/2023/04/20/%E8%AE%A2%E5%8D%95%E8%B6%85%E6%97%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-RabbitMQ%E6%AD%BB%E4%BF%A1%E9%98%9F%E5%88%97/" title="订单超时解决方案-RabbitMQ死信队列">订单超时解决方案-RabbitMQ死信队列</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-04-20T15:16:26.000Z" title="发表于 2023-04-20 23:16:26">2023-04-20</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/liukai/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BB%84%E4%BB%B6/">分布式组件</a></span></div><div class="content">RabbitMQ死信队列解决订单超时
摘要:
本文主要介绍利用分布式组件RabbitMQ解决订单超时的问题

1  死信以及TTL概念
死信，在官网中对应的单词为“Dead Letter”;
它是RabbitMQ中的一种消息机制
TTL：即消息的存活时间。RabbitMQ可以对队列和消息分别设置TTL，如果对队列设置，则队列中所有的消息都具有相同的过期时间。超过了这个时间，我们认为这个消息就死了，称之为死信。

1.1 队列中消息出现死信的几种情况

消息被否定确认,其实就是呗消费者拒绝.使用 channel.basicNack 或 channel.basicReject ，并且此时requeue 属性被设置为false;
消息在队列中存活的时间超过设置的TTL时间;
消息在队列的消息数量已经超过了最大的队列长度;(队列可以设置最大消息数量的属性,如果超出了这个范围那么多出来的就是死信).


1.2  如何配置死信队列
上面说到三种消息成为死信的情况,那么我们成为死信的消息将”何去何从”呢?
其实我们一样可以创建一个专门接收死信的队列来存放管理这些消息—死信队列
死信队列其实就是一个 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/liukai/page/2/#content-inner">2</a><a class="extend next" rel="next" href="/liukai/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/loading.gif" data-original="/liukai/img/avatar.png" onerror="this.onerror=null;this.src='/liukai/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">liukai</div><div class="author-info__description">一个不掉头发的Java程序员~~~</div></div><div class="card-info-data site-data is-center"><a href="/liukai/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/liukai/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/liukai/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mrkay001"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://blog.csdn.net/weixin_44848900" target="_blank" title="CSDN"><i class="fa fa-book-open"></i></a><a class="social-icon" href="mailto:1319897531@qq.com" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">感谢各位百忙之中浏览本人博客，博客基于hexo构建。主要用于记录个人技术总结，如果图片出不来可能是缓存原因请刷新页面或者清理浏览器缓存试一下哦~~~最后左下角可以和博主一起"网抑云"哦~~~</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/liukai/2023/05/25/%E7%BC%93%E5%AD%98Redis%E7%9B%B8%E5%85%B3%E5%8A%9F%E8%83%BD/" title="缓存Redis相关功能">缓存Redis相关功能</a><time datetime="2023-05-25T15:22:05.000Z" title="发表于 2023-05-25 23:22:05">2023-05-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/liukai/2023/05/25/OpenFeign/" title="OpenFeign">OpenFeign</a><time datetime="2023-05-25T15:06:04.000Z" title="发表于 2023-05-25 23:06:04">2023-05-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/liukai/2023/05/20/SPEL%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="SPEL表达式">SPEL表达式</a><time datetime="2023-05-20T14:37:10.000Z" title="发表于 2023-05-20 22:37:10">2023-05-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/liukai/2023/05/14/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE-Gateway%E8%B6%85%E6%97%B6%E9%85%8D%E7%BD%AE/" title="Pig开源项目-Gateway超时配置">Pig开源项目-Gateway超时配置</a><time datetime="2023-05-14T15:47:32.000Z" title="发表于 2023-05-14 23:47:32">2023-05-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/liukai/2023/05/14/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE-%E7%BD%91%E5%85%B3%E9%99%90%E6%B5%81/" title="Pig开源项目-网关限流">Pig开源项目-网关限流</a><time datetime="2023-05-14T09:01:09.000Z" title="发表于 2023-05-14 17:01:09">2023-05-14</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"><span class="card-category-list-name">Pig开源项目</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/Spring/"><span class="card-category-list-name">Spring</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BB%84%E4%BB%B6/"><span class="card-category-list-name">分布式组件</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%BA%BF%E7%A8%8B%E6%B1%A0/"><span class="card-category-list-name">多线程线程池</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"><span class="card-category-list-name">微服务</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/%E6%95%99%E7%A8%8B/"><span class="card-category-list-name">教程</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/liukai/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="card-category-list-name">数据库</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/liukai/tags/%E7%89%B9%E6%AE%8Ajava%E6%96%87%E4%BB%B6/" style="font-size: 1.1em; color: #999">特殊java文件</a> <a href="/liukai/tags/Gateway%E8%B6%85%E6%97%B6%E9%85%8D%E7%BD%AE/" style="font-size: 1.1em; color: #999">Gateway超时配置</a> <a href="/liukai/tags/hexo/" style="font-size: 1.1em; color: #999">hexo</a> <a href="/liukai/tags/%E6%8F%92%E4%BB%B6/" style="font-size: 1.1em; color: #999">插件</a> <a href="/liukai/tags/%E7%BD%91%E5%85%B3/" style="font-size: 1.1em; color: #999">网关</a> <a href="/liukai/tags/CountDownLatch/" style="font-size: 1.1em; color: #999">CountDownLatch</a> <a href="/liukai/tags/ScheduledExecutorService/" style="font-size: 1.1em; color: #999">ScheduledExecutorService</a> <a href="/liukai/tags/redis-reactive%E9%99%90%E6%B5%81%E7%BB%84%E4%BB%B6/" style="font-size: 1.1em; color: #999">redis-reactive限流组件</a> <a href="/liukai/tags/Redis/" style="font-size: 1.1em; color: #999">Redis</a> <a href="/liukai/tags/openfeign/" style="font-size: 1.1em; color: #999">openfeign</a> <a href="/liukai/tags/SPEL/" style="font-size: 1.1em; color: #999">SPEL</a> <a href="/liukai/tags/MQ/" style="font-size: 1.5em; color: #99a9bf">MQ</a> <a href="/liukai/tags/butterfly/" style="font-size: 1.1em; color: #999">butterfly</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/liukai/archives/2023/05/"><span class="card-archive-list-date">五月 2023</span><span class="card-archive-list-count">8</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/liukai/archives/2023/04/"><span class="card-archive-list-date">四月 2023</span><span class="card-archive-list-count">5</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">13</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">9.3k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-10-01T09:57:38.824Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/liukai/img/background.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2023 By liukai</div><div class="footer_custom_text">~~人生短短数十年,技术永远学不完~~</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/liukai/js/utils.js"></script><script src="/liukai/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js/dist/typed.umd.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["LIFE IS A STRUGGLE."])
  } else {
    document.getElementById("subtitle").innerHTML = 'LIFE IS A STRUGGLE.'
  }
}
typedJSFn.run(subtitleType)</script></div><div class="aplayer no-destroy" data-id="8301894281" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true"> </div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="false" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/liukai/js/search/local-search.js"></script></div></div><script src="/liukai/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/liukai/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>